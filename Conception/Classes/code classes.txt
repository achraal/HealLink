@startuml healLink_classes
!theme plain
skinparam classAttributeIconSize 0

title HealLink - Diagramme Classes

class Utilisateur {
  -uid : String (Firebase ID utilisateur)
  -email : String (Identifiant)
  -createdAt : DateTime (Date de création)
  -lastSignIn : DateTime (Dernière connexion)
}

class Campagne {
  -id : ObjectId
  -nom : String
  -centre : String
  -latitude : float
  -longitude : float
  -stockVaccins : int
  -categorie : String
  -dateDebut : Date
  -dateFin : Date
  -pochesDeSang : int
}

class Cagnotte {
  -id : ObjectId
  -titre : String
  -description : String
  -objectif : float
  -collecte : float
  -date_debut : Date
  -date_fin : Date
  -est_active : boolean
  +contribuer(montant: float)
}

class Don {
  -id : ObjectId
  -montant : float
  -message : String
  -date_don : DateTime
  -cagnotte_id : String
}

class WebSocketClient {
  -client_id : String (UUID généré backend)
  -websocket : WebSocket
  +send_json(payload: JSON)
  +receive_text()
  +on_welcome(userID: String)
  +on_poke()
}

' Relations métier PURES
Utilisateur "1" ||-- "0..*" Don : effectue
Cagnotte "1" ||-- "0..*" Don : reçoit

note right of Utilisateur
  Authentification Firebase
  (email/password)
end note

note right of WebSocketClient
  Système "poke" entre utilisateurs :
  • Backend assigne client_id (UUID)
  • Frontend envoie client_id cible
  → Backend poke l'utilisateur cible
  → Alert "Success" React Native
end note

note right of Don
  cagnotte_id : String (référence)
  date_don générée backend (UTC)
end note

note bottom of Cagnotte
  pourcentage calculé :
  min(100, (collecte/objectif)*100)
end note

@enduml
